<DepartmentVM>
@{
	ViewData["Title"] = "Master Department";
}
<head>
		<link href="~/assets/css/popup.css" rel="stylesheet" />
</head>
<style>
		.grid-scroll {
			max-height: 350px;
			overflow-y: auto;
		}

		label.required::after {
			content: " *";
			color: red;
		}


</style>
	<!-- PAGE HEADER -->
	<div class="d-flex justify-content-between align-items-center mb-3">
		<h4 class="page-title">Master Department</h4>

		<button class="btn btn-primary"
				data-bs-toggle="modal"
				data-bs-target="#designationModal"
				onclick="clearForm()">
			<i class="ti ti-plus"></i> Add Department
		</button>
	</div>

	<div class="row mb-2">
		<div class="col-md-6">
			<select id="pageSize" class="form-select" style="width:120px">
				<option value="5">Top 5</option>
				<option value="10" selected>Top 10</option>
				<option value="25">Top 25</option>
				<option value="100">Top 100</option>
			</select>
		</div>

		<div class="col-md-6 text-end">
			<input type="text"
				   id="searchBox"
				   class="form-control"
				   placeholder="Search department..."
				   style="width:250px; display:inline-block;">
		</div>
	</div>


	<!-- LIST -->
	<div class="card">
		<div class="table-responsive grid-scroll">
			<table class="table table-hover" id="deptTable">
				<thead>
					<tr>
						<th>Sr. No.</th>
						<th>Department Name</th>
						<th width="120">Action</th>
					</tr>
				</thead>
				<tbody>
					@for (int i = 0; i < Model.Count; i++)
					{
						<tr>
							<td>@(i + 1)</td>
							<td>@Model[i].Department</td>
							<td>
								<button class="btn btn-sm btn-warning"
										onclick="editDesignation('@Model[i].Id',
																	 '@Model[i].Department')">
									<i class="ti ti-edit"></i>
								</button>

								<form asp-action="DeleteDepartment" method="post" style="display:inline">
									<input type="hidden" name="id" value="@Model[i].Id" />
									<button class="btn btn-sm btn-danger"
											onclick="return confirm('Do you really want to delete this record?')">
										<i class="ti ti-trash"></i>
									</button>
								</form>
							</td>
						</tr>
					}
				</tbody>
			</table>
		</div>
	</div>

	<div class="d-flex justify-content-end mt-2">
		<ul class="pagination" id="pagination"></ul>
	</div>


	<!-- ADD / EDIT MODAL -->
	<div class="modal fade" id="designationModal">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">

				<form asp-action="AddDepartment" method="post">
					<div class="modal-header">
						<h5 class="modal-title">Add New Department</h5>
						<button type="button"
								class="btn-close"
								data-bs-dismiss="modal"></button>
					</div>

					<div class="modal-body">
						<input type="hidden" id="Id"
							   name="Id" />

						<label class="form-label required">Department Name</label>
						<input type="text"
							   class="form-control"
							   name="Department"
							   id="Department"
							   required />
					</div>

					<div class="modal-footer">
						<button class="btn btn-secondary"
								data-bs-dismiss="modal">
							Cancel
						</button>
						<button class="btn btn-primary">Save</button>
					</div>
				</form>

			</div>
		</div>
	</div>
	<!-- ================= CENTER POPUP ================= -->
@if (TempData["Msg"] != null)
{
		<div class="popup-overlay" id="centerPopup">
			<div class="popup-box">
				<h4>Success</h4>
				<p>@TempData["Msg"]</p>
			</div>
		</div>
}


	<script src="~/assets/js/global.js"></script>
@section Scripts {
		<script>

				 const popup = document.getElementById("centerPopup");
			if (popup) {
				setTimeout(() => popup.remove(), 1200);
			}

			function clearForm() {
				document.getElementById("Id").value = "";
				document.getElementById("Department").value = "";
			}

			function editDesignation(id, name) {
				document.getElementById("Id").value = id;
				document.getElementById("Department").value = name;
				new bootstrap.Modal(
					document.getElementById('designationModal')
				).show();
			}
		</script>
}
